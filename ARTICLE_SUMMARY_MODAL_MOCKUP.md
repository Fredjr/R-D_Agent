# Article Summary Modal - Visual Mockup

## Design Specifications

### Modal Dimensions
- **Width**: 480px (max-w-md)
- **Max Height**: 600px (scrollable if needed)
- **Position**: Center of screen
- **Backdrop**: Semi-transparent black (bg-black/20)
- **Animation**: Fade in/out (200ms)

---

## State 1: Loading State

```
┌────────────────────────────────────────────────────────────┐
│  Efficacy of low-dose aspirin in the prevention of...  [X]│
├────────────────────────────────────────────────────────────┤
│                                                            │
│                    ⟳  Generating summary...                │
│                                                            │
│                                                            │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

**Features**:
- Spinning loader icon
- "Generating summary..." text
- Title truncated with ellipsis
- Close button (X) in top-right

---

## State 2: Success State (Summary Loaded)

```
┌────────────────────────────────────────────────────────────┐
│  Efficacy of low-dose aspirin in the prevention of...  [X]│
├────────────────────────────────────────────────────────────┤
│                                                            │
│  🤖 AI Summary                                             │
│                                                            │
│  This randomized controlled trial investigated the         │
│  efficacy of low-dose aspirin (75-100mg daily) in          │
│  preventing cardiovascular events in high-risk patients.   │
│  The study enrolled 15,480 participants across 120         │
│  centers and followed them for a median of 5.2 years.      │
│  Results showed a 22% reduction in major cardiovascular    │
│  events (p<0.001) with aspirin compared to placebo,        │
│  though with a modest increase in bleeding risk. These     │
│  findings support aspirin as an effective preventive       │
│  therapy for high-risk populations.                        │
│                                                            │
│  ✓ Cached • Generated by Gemini 1.5 Flash                 │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │           View Full Details in Sidebar               │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

**Features**:
- Robot emoji (🤖) to indicate AI-generated
- Clear, readable summary text
- Cache indicator (✓ Cached) for transparency
- Model attribution (Gemini 1.5 Flash)
- "View Full Details" button to open sidebar
- Close button (X) always visible

---

## State 3: Error State (No Abstract Available)

```
┌────────────────────────────────────────────────────────────┐
│  Efficacy of low-dose aspirin in the prevention of...  [X]│
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ⚠️  Summary Unavailable                                   │
│                                                            │
│  This article does not have an abstract available in       │
│  PubMed, so we cannot generate an AI summary.              │
│                                                            │
│  You can still view the full article details in the        │
│  sidebar or visit the publisher's website.                 │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │           View Full Details in Sidebar               │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

**Features**:
- Warning icon (⚠️) to indicate error
- Clear explanation of why summary is unavailable
- Helpful suggestion (view sidebar or visit website)
- "View Full Details" button still available
- Close button (X) always visible

---

## State 4: Error State (API Failure)

```
┌────────────────────────────────────────────────────────────┐
│  Efficacy of low-dose aspirin in the prevention of...  [X]│
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ❌  Could Not Generate Summary                            │
│                                                            │
│  We encountered an error while generating the summary.     │
│  This might be due to temporary API issues.                │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │                  Try Again                           │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │           View Full Details in Sidebar               │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

**Features**:
- Error icon (❌) to indicate failure
- Clear error message
- "Try Again" button to retry
- "View Full Details" button as fallback
- Close button (X) always visible

---

## Color Scheme (Tailwind CSS)

### Background
- Modal: `bg-white`
- Backdrop: `bg-black/20`

### Text
- Title: `text-gray-900 font-semibold text-sm`
- Summary: `text-gray-700 text-sm leading-relaxed`
- Meta info: `text-gray-500 text-xs`

### Buttons
- Primary: `bg-blue-600 hover:bg-blue-700 text-white`
- Secondary: `bg-gray-100 hover:bg-gray-200 text-gray-700`
- Close (X): `text-gray-400 hover:text-gray-600`

### Icons
- Loading: `text-blue-600`
- Success (✓): `text-green-600`
- Warning (⚠️): `text-yellow-600`
- Error (❌): `text-red-600`

---

## Interaction Behaviors

### Opening
1. User clicks on paper card in network view
2. Modal fades in (200ms)
3. Backdrop appears
4. Loading state shows immediately
5. Summary fetches in background

### Closing
1. User clicks X button → Modal fades out
2. User clicks backdrop → Modal fades out
3. User presses ESC key → Modal fades out
4. User clicks "View Full Details" → Modal closes + Sidebar opens

### Loading
1. Show spinner + "Generating summary..." text
2. Disable "View Full Details" button during loading
3. Keep close button (X) enabled

### Success
1. Fade out loading state
2. Fade in summary text
3. Show cache indicator
4. Enable "View Full Details" button

### Error
1. Fade out loading state
2. Fade in error message
3. Show appropriate icon
4. Enable "Try Again" or "View Full Details" button

---

## Accessibility Features

### Keyboard Navigation
- **ESC**: Close modal
- **TAB**: Navigate between buttons
- **ENTER**: Activate focused button

### Screen Readers
- Modal has `role="dialog"`
- Modal has `aria-labelledby` pointing to title
- Modal has `aria-describedby` pointing to summary
- Close button has `aria-label="Close summary"`
- Loading state announces "Generating summary"

### Focus Management
- Focus trapped within modal when open
- Focus returns to clicked card when closed
- First focusable element (close button) receives focus on open

---

## Responsive Design

### Desktop (≥768px)
- Width: 480px
- Position: Center of screen
- Padding: 24px

### Tablet (640px - 767px)
- Width: 90% of screen
- Max width: 480px
- Position: Center of screen
- Padding: 20px

### Mobile (<640px)
- Width: 95% of screen
- Position: Center of screen
- Padding: 16px
- Font size: Slightly smaller (text-xs)

---

## Animation Specifications

### Fade In
```css
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.modal-enter {
  animation: fadeIn 200ms ease-out;
}
```

### Fade Out
```css
@keyframes fadeOut {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.95);
  }
}

.modal-exit {
  animation: fadeOut 200ms ease-in;
}
```

---

## Component Props (TypeScript)

```typescript
interface ArticleSummaryModalProps {
  // Required
  pmid: string;                    // PubMed ID
  title: string;                   // Article title
  isOpen: boolean;                 // Modal visibility
  onClose: () => void;             // Close handler
  
  // Optional
  onViewDetails?: () => void;      // Open sidebar handler
  position?: { x: number; y: number }; // Custom position
  className?: string;              // Additional CSS classes
}
```

---

## Example Usage

```tsx
import { ArticleSummaryModal } from '@/components/ArticleSummaryModal';

function NetworkView() {
  const [showSummary, setShowSummary] = useState(false);
  const [selectedPmid, setSelectedPmid] = useState<string | null>(null);
  const [selectedTitle, setSelectedTitle] = useState<string>('');
  
  const handleNodeClick = (node: NetworkNode) => {
    setSelectedPmid(node.metadata.pmid);
    setSelectedTitle(node.metadata.title);
    setShowSummary(true);
  };
  
  const handleViewDetails = () => {
    setShowSummary(false);
    setShowSidebar(true); // Open existing sidebar
  };
  
  return (
    <>
      {/* Network graph */}
      <ReactFlow nodes={nodes} edges={edges} onNodeClick={handleNodeClick} />
      
      {/* Summary modal */}
      <ArticleSummaryModal
        pmid={selectedPmid || ''}
        title={selectedTitle}
        isOpen={showSummary}
        onClose={() => setShowSummary(false)}
        onViewDetails={handleViewDetails}
      />
    </>
  );
}
```

---

## Performance Considerations

### Lazy Loading
- Modal component loaded only when first needed
- Gemini API client initialized on first summary request

### Caching
- Summaries cached in database by PMID
- Cache checked before API call
- Cache hit: ~100ms response time
- Cache miss: ~2-3 seconds response time

### Optimization
- Debounce rapid clicks (prevent multiple API calls)
- Cancel pending requests if modal closed
- Preload summaries for visible nodes (optional future enhancement)

---

## Future Enhancements (Optional)

### Phase 2 Features
1. **Copy Summary Button**: Allow users to copy summary to clipboard
2. **Share Summary**: Generate shareable link with summary
3. **Regenerate Summary**: Allow users to request new summary
4. **Summary Quality Rating**: Thumbs up/down for feedback
5. **Summary History**: Show previous versions of summary

### Phase 3 Features
1. **Custom Summary Length**: Let users choose short/medium/long
2. **Summary Language**: Translate summary to user's language
3. **Summary Highlights**: Highlight key terms in summary
4. **Related Papers**: Show similar papers based on summary
5. **Export Summary**: Download summary as PDF/text

---

**Status**: Ready for implementation
**Design System**: Tailwind CSS + Heroicons
**Framework**: React + TypeScript
**Estimated Build Time**: 2-3 hours for frontend component

